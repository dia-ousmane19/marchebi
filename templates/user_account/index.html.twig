{% extends 'base.html.twig' %}

{% block title %}Mon compte{% endblock %}
{% block stylesheets %}
<link href="{{ asset('css/jumbotron.css') }}" rel="stylesheet">
{% endblock %}
{% block javascripts %}
<script src='https://kit.fontawesome.com/a076d05399.js'></script>
<!-- <script src=https://touchpay.gutouch.com/touchpay/script/prod_touchpay-0.0.1.js type="text/javascript"> </script>
<script type="text/javascript">
function sendPaymentInfos(123, 'INTDK6177', '6K5Ck6IqrSp7e3l6aswSuh4orVAdrevriIrqbjU7YE7QXRLKBR' ,'https://127.0.0.1:8004/', 'https://127.0.0.1:8004/annonces/new' ,'https://127.0.0.1:8004/mon-compte' ,1000 , 'Dakar' , 'ousmane19@gmail.com', 'dia', 'dieumb', '771237657') {}
</script> -->
{% endblock %}
{% block body %}

<div class="d-flex fixed-top flex-column flex-md-row align-items-center p-3 px-md-4 mb-3 bg-white border-bottom box-shadow">
  <a class="my-0 mr-md-auto mb-2" href="{{ path ('home')}}"><img  src="{{ asset('images/logo.jpg')}}" alt="" width="128" height="128"></a>
  <nav class="my-2 my-md-0 mr-md-3">
    <!-- <button type="button" class="btn btn-sm btn-outline-secondary"><i class='fas fa-user'></i> </button> -->
  </nav>
  <a class="btn btn-sm btn-outline-primary m-1" href="{{ path('home') }}">Voir les annonces</a>
  <a class="btn btn-sm btn-outline-primary" href="{{ path('app_logout') }}">Me deconnecter</a>
</div>

<main role="main" id="mon-compte">
  <div class="container">
    <ul class="nav nav-tabs" id="myTab" role="tablist">
      <li class="nav-item m-1">
        <a class="nav-link btn btn-sm btn-primary" id="profile-tab" data-toggle="tab" href="#profile" role="tab" aria-controls="profile" aria-selected="false">Accueil</a>
      </li>
      <li class="nav-item m-1">
        <a class="nav-link btn btn-sm btn-primary " id="home-tab" data-toggle="tab" href="#home" role="tab" aria-controls="home" aria-selected="true">Mes annonces expirées</a>
      </li>

      <li class="nav-item m-1">
        <a class="nav-link btn btn-sm btn-primary" id="Annonce-En-ligne-tab" data-toggle="tab" href="#AnnonceEnligne" role="tab" aria-controls="AnnonceEnligne"  aria-selected="false">Mes annonces en ligne</a>
      </li>

    </ul>
    <div class="tab-content" id="myTabContent">
      <div class="tab-pane fade " id="home" role="tabpanel" aria-labelledby="home-tab">
        <div class="">
          <h2> <span class="badge badge-primary">Mes annonces expirées</span> </h2>
          <div class="album py-5 bg-light">
            <div class="container">

              <div class="row">
                {% for MesAnnonce in users %}
                <div class="col-md-4">

                  <div class="card mb-4 box-shadow">
                    {% for MesImages in MesAnnonce.images %}

                    {% if MesImages.imagePrincipale == true %}
                    <img class="d-block w-100 card-img-top"  src="{{ asset('/uploads/images/images_annonces/')}}{{MesImages.nom}}" alt="Card image cap">

                    {% endif %}
                    {% endfor %}
                    <div class="card-body">
                      <h4><a href="{{ path('annonce',{'slug':MesAnnonce.slug}) }}">{{ MesAnnonce.titre}}</a> </h4>
                      <h4>{{ MesAnnonce.prix}} FCFA</h4>

                      <small class="text-muted">{{ MesAnnonce.users.nomComplet}}</small>
                      <p class="card-text">{{ MesAnnonce.description |slice(0,100) |raw}}</p>
                      <div class="d-flex justify-content-between align-items-center">
                        <div class="btn-group">
                          <a href="{{ path('annonce',{'slug':MesAnnonce.slug}) }}" type="button" class="btn btn-sm btn-outline-secondary">Voir</a>

                        </div>
                        <small class="text-muted">{{ MesAnnonce.updatedAt |format_date}}</small>
                        <small class="alert alert-danger text-muted">expirée le {{ MesAnnonce.expiredAt |format_date}}</small>

                      </div>
                      <small class="text-muted"> <a href="{{ path('ImagePrincipale',{'slug':MesAnnonce.id}) }}">Veuillez choisir une principal</a> </small>
                    </div>
                  </div>
                </div>
                {% else %}
                <div class="alert alert-warning">
                  Il y n'a pas encore d'annonce expirée
                </div>
                {% endfor %}

              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="tab-pane fade show active" id="profile" role="tabpanel" aria-labelledby="profile-tab">
        <div class="jumbotron jumbotron-fluid border border-primary rounded">
          <div class="container">
            <h2 class=""><span class="badge badge-primary">{{user.nomComplet}}</span></h2>
            <p class="lead">This is a modified jumbotron that occupies the entire horizontal space of its parent.</p>
            <a class="btn btn-sm btn-primary" href="{{ path('annonces_new')}}">Publier une annonce</a>

          </div>
        </div>
      </div>
      <div class="tab-pane fade" id="AnnonceEnligne" role="tabpanel" aria-labelledby="Annonce-En-ligne-tab">
        <!-- debu annonce en ligne -->
        <h2> <span class="badge badge-primary">Mes annonces en ligne</span> </h2>
        <div class="album py-5 bg-light">
          <div class="container">

            <div class="row">
              {% for MesAnnonceEnLigne in usersEnLigne %}
              <div class="col-md-4">

                <div class="card mb-4 box-shadow">
                  {% for MesImages in MesAnnonceEnLigne.images %}

                  {% if MesImages.imagePrincipale == true %}
                  <a href="{{ path('ImagePrincipale',{'idAnnonce':MesAnnonceEnLigne.id}) }}"><img class="d-block w-100 card-img-top"  src="{{ asset('/uploads/images/images_annonces/')}}{{MesImages.nom}}" alt="Card image cap"></a>


                  {% endif %}
                  {% endfor %}
                  <div class="card-body">
                    <h4><a href="{{ path('annonce',{'slug':MesAnnonceEnLigne.slug}) }}">{{ MesAnnonceEnLigne.titre}}</a> </h4>
                    <h4>{{ MesAnnonceEnLigne.prix}} FCFA</h4>

                    <small class="text-muted">{{ MesAnnonceEnLigne.users.nomComplet}}</small>
                    <p class="card-text">{{ MesAnnonceEnLigne.description |slice(0,100) |raw}}</p>
                    <div class="d-flex justify-content-between align-items-center">
                      <div class="btn-group">
                        <a href="{{ path('annonce',{'slug':MesAnnonceEnLigne.slug}) }}" type="button" class="btn btn-sm btn-outline-secondary">Voir</a>

                      </div>

                      <small class="text-muted">{{ MesAnnonceEnLigne.updatedAt |format_date}}</small>
                      <small class="alert alert-danger text-muted">expirée le {{ MesAnnonceEnLigne.expiredAt |format_date}}</small>
                    </div>
                    <a href="{{ path('ImagePrincipale',{'idAnnonce':MesAnnonceEnLigne.id}) }}"><span class="badge badge-danger">Choisir une image pour votre annonce</span></a>

                  </div>
                </div>
              </div>
              {% else %}
              <div class="alert alert-warning">
                Il y n'a pas encore d'annonce en ligne
              </div>
              {% endfor %}


            </div>
          </div>
          <!-- fin annonce en ligne -->
        </div>

      </div>
    </div>

    <!-- Main jumbotron for a primary marketing message or call to action -->

    <div class="container">
      <div class="">
        <!-- debu annonce en ligne -->

        <!-- fin -->
      </div>

      <!-- annonce expirer -->
      <!-- fin -->

      {{ include('partials/footer.html.twig') }}
    </div> <!-- /container -->
  </main>
{% endblock %}
